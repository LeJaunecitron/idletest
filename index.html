<html>

<head>
	<title>The Cancer Idle</title>
</head>

<body>
	<small>source code on <a
			href="https://github.com/Dimava/dimava.github.io/blob/master/idle-game-examples/cancer/index.html">Github</a></small>


	<div id="elCoinsContainer"> Coins: <span id="elCoins"></span> </div>
	<div id="elWorkerContainer"> Workers: <span id="elWorkerCount"></span> </div>
	<br>

	<button onclick="game.getCoin()"> Get a coin </button>
	<button id="btnBuyWorker"> Get a worker (<span id="elWorkerCost"></span> coins)</button>
	<br>
	<div id="elEndGame"> There is no more content in the game </div>
	<button style="float: right;" onclick="game.clearSave()"> Reset game </button>


	<script>
		/** everything that saves goes here */
		var data = {
			coins: 0,
			workers: 0,
		};
		/** everything that is function goes here */
		var game = {
			/** initialization goes here */
			init() {
				
				btnBuyWorker.onclick = () => game.getWorker();
			},
			/** everything that updates goes here */
			tick() {
				data.coins += data.workers;

				game.updateDisplay();
			},
			/** everything that draws goes here */
			updateDisplay() {
				
				elCoins.innerText = data.coins;
				elWorkerContainer.hidden = data.workers == 0 && !game.canGetWorker();
				elWorkerCost.innerText = game.getWorkerCost();
				elWorkerCount.innerText = data.workers;
				elEndGame.hidden = data.workers < 2;

			},

			getCoin() {
				data.coins++;
				game.updateDisplay();
			},

			getWorkerCost() {
				return data.workers + 10;
			},
			canGetWorker() {
				return data.coins >= game.getWorkerCost();
			},
			getWorker() {
				if (game.canGetWorker()) {
					data.coins -= game.getWorkerCost();
					data.workers++;
				}
				game.updateDisplay();
			},

			
			save(savename = 'cancersave') {
				localStorage.setItem(savename, JSON.stringify(data));
			},
			load(savename = 'cancersave') {
				Object.assign(data, JSON.parse(localStorage.getItem(savename) || '{}'));
				game.init();
				game.updateDisplay();
			},
			clearSave(savename = 'cancersave') {
				localStorage.setItem(savename, '{}');
				location.reload();
			},
			start() {
				// using setInterval is an okay practice, it has its own features and problems
				setInterval(() => game.tick(), /* 1 second */ 1e3);
				setInterval(() => game.save(), /* 10 seconds */ 10e3);
			},
		}
		game.load();
		game.start();
	</script>


</body>

</html>
